<!DOCTYPE html>
<html>
  <head>
    <title>Pedido #<%= @order.id %></title>
    <%= csrf_meta_tags %>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <%= stylesheet_link_tag    'application', media: 'all' %>
    <style>
      .ident {
        /*border: 1px solid #dedede;*/
        /*padding: 5px;*/
        width: 100%;
      }

      .ident td {
        padding: 5px;
      }

      .bg {
        text-align: right;
      }
      .row { font-size: 10px; }
      td { padding: 5px !important; }
    </style>
  </head>

  <body>
    <div class="row" style="margin-bottom: 0;">
      <table class="ident">
        <tbody>
          <tr>
            <td width="10%" class="bg">Pedido</td>
            <td><%= @order.id %> - <%= l(@order.created_at.to_date).split("-")[0] %></td>
            <td width="10%" class="bg">Vendedor</td>
            <td colspan="3"><%= @order.user.try(:email) || "Não informado" %></td>
          </tr>
          <tr>
            <td class="bg">Cliente</td>
            <td><%= @order.client.try(:company) || "Não informado" %></td>
            <td class="bg">Telefone</td>
            <td><%= @order.client.try(:phone) || "Não informado" %></td>
            <td width="10%" class="bg">CPF/CNPJ</td>
            <td><%= @order.client.try(:cpf) || "Não informado" %></td>
          </tr>
          <tr>
            <td class="bg">Endereço</td>
            <td colspan="3"><%= @order.client.try(:address) || "Não informado" %> <%= @order.client.try(:cep) %></td>
            <td class="bg">Cidade</td>
            <td><%= @order.client.try(:city) || "Não informado" %> <%= @order.client.try(:uf) %></td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="row">
      <table class="striped">
        <thead>
          <tr>
              <th data-field="item" width="">Produto</th>
              <th data-field="unit" width="">Valor</th>
              <th data-field="quantity" width="">Quantidade</th>
              <th data-field="total" width="">Total</th>
          </tr>
        </thead>

        <tbody>
          <% @order.order_items.each do |oi| %>
            <tr>
              <td><%= oi.item.name %></td>
              <td><%= number_to_currency oi.unit_price %></td>
              <td><%= oi.quantity %></td>
              <td><%= number_to_currency oi.total_price %></td>
            </tr>
          <% end %>

          <% @order.order_tintas.each do |oi| %>
            <tr>
              <td>
                <%= oi.rformula.color.split("-").first %> (<%= oi.can.try(:humanize) %>)
                <span style="font-size: .8em; display: block;"><%= oi.rformula.rline.name %></span>
                <span style="font-size: .8em; display: block;"><%= oi.rformula.rproduct.code %></span>
              </td>
              <td><%= number_to_currency oi.unit_price %></td>
              <td><%= oi.quantity %></td>
              <td><%= number_to_currency oi.total_price %></td>
            </tr>
          <% end %>
          <tr>
            <td colspan='3' class="right-align">Total:</td>
            <td><%= number_to_currency @order.total %></td>
          </tr>
        </tbody>
      </table>
    </div>
<script>
window.print();
</script>
  </body>
</html>
